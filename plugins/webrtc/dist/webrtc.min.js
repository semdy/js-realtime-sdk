!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?b(exports,require("leancloud-realtime")):"function"==typeof define&&define.amd?define("webrtc",["exports","leancloud-realtime"],b):b(a.AV=a.AV||{},a.AV)}(this,function(a,b){"use strict";function c(a){return a&&"object"==typeof a&&"default"in a?a.default:a}function d(a,b){return b={exports:{}},a(b,b.exports),b.exports}var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},f=d(function(a){a.exports=function(){}}),g=c(f),h=Object.freeze({default:g}),i=d(function(a){a.exports=function(a,b){return{value:b,done:!!a}}}),j=c(i),k=Object.freeze({default:j}),l=d(function(a){a.exports={}}),m=c(l),n=Object.freeze({default:m}),o=d(function(a){var b={}.toString;a.exports=function(a){return b.call(a).slice(8,-1)}}),p=c(o),q=Object.freeze({default:p}),r=d(function(a){var b=c(q);a.exports=Object("z").propertyIsEnumerable(0)?Object:function(a){return"String"==b(a)?a.split(""):Object(a)}}),s=c(r),t=Object.freeze({default:s}),u=d(function(a){a.exports=function(a){if(void 0==a)throw TypeError("Can't call method on  "+a);return a}}),v=c(u),w=Object.freeze({default:v}),x=d(function(a){var b=c(t),d=c(w);a.exports=function(a){return b(d(a))}}),y=c(x),z=Object.freeze({default:y}),A=d(function(a){a.exports=!0}),B=c(A),C=Object.freeze({default:B}),D=d(function(a){var b=a.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=b)}),E=c(D),F=Object.freeze({default:E}),G=d(function(a){var b=a.exports={version:"2.4.0"};"number"==typeof __e&&(__e=b)}),H=c(G),I=G.version,J=Object.freeze({default:H,version:I}),K=d(function(a){a.exports=function(a){if("function"!=typeof a)throw TypeError(a+" is not a function!");return a}}),L=c(K),M=Object.freeze({default:L}),N=d(function(a){var b=c(M);a.exports=function(a,c,d){if(b(a),void 0===c)return a;switch(d){case 1:return function(b){return a.call(c,b)};case 2:return function(b,d){return a.call(c,b,d)};case 3:return function(b,d,e){return a.call(c,b,d,e)}}return function(){return a.apply(c,arguments)}}}),O=c(N),P=Object.freeze({default:O}),Q=d(function(a){a.exports=function(a){return"object"==typeof a?null!==a:"function"==typeof a}}),R=c(Q),S=Object.freeze({default:R}),T=d(function(a){var b=c(S);a.exports=function(a){if(!b(a))throw TypeError(a+" is not an object!");return a}}),U=c(T),V=Object.freeze({default:U}),W=d(function(a){a.exports=function(a){try{return!!a()}catch(a){return!0}}}),X=c(W),Y=Object.freeze({default:X}),Z=d(function(a){a.exports=!c(Y)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})}),$=c(Z),_=Object.freeze({default:$}),aa=d(function(a){var b=c(S),d=c(F).document,e=b(d)&&b(d.createElement);a.exports=function(a){return e?d.createElement(a):{}}}),ba=c(aa),ca=Object.freeze({default:ba}),da=d(function(a){a.exports=!c(_)&&!c(Y)(function(){return 7!=Object.defineProperty(c(ca)("div"),"a",{get:function(){return 7}}).a})}),ea=c(da),fa=Object.freeze({default:ea}),ga=d(function(a){var b=c(S);a.exports=function(a,c){if(!b(a))return a;var d,e;if(c&&"function"==typeof(d=a.toString)&&!b(e=d.call(a)))return e;if("function"==typeof(d=a.valueOf)&&!b(e=d.call(a)))return e;if(!c&&"function"==typeof(d=a.toString)&&!b(e=d.call(a)))return e;throw TypeError("Can't convert object to primitive value")}}),ha=c(ga),ia=Object.freeze({default:ha}),ja=d(function(a,b){var d=c(V),e=c(fa),f=c(ia),g=Object.defineProperty;b.f=c(_)?Object.defineProperty:function(a,b,c){if(d(a),b=f(b,!0),d(c),e)try{return g(a,b,c)}catch(a){}if("get"in c||"set"in c)throw TypeError("Accessors not supported!");return"value"in c&&(a[b]=c.value),a}}),ka=c(ja),la=ja.f,ma=Object.freeze({default:ka,f:la}),na=d(function(a){a.exports=function(a,b){return{enumerable:!(1&a),configurable:!(2&a),writable:!(4&a),value:b}}}),oa=c(na),pa=Object.freeze({default:oa}),qa=d(function(a){var b=c(ma),d=c(pa);a.exports=c(_)?function(a,c,e){return b.f(a,c,d(1,e))}:function(a,b,c){return a[b]=c,a}}),ra=c(qa),sa=Object.freeze({default:ra}),ta=d(function(a){var b=c(F),d=c(J),e=c(P),f=c(sa),g="prototype",h=function(a,c,i){var j,k,l,m=a&h.F,n=a&h.G,o=a&h.S,p=a&h.P,q=a&h.B,r=a&h.W,s=n?d:d[c]||(d[c]={}),t=s[g],u=n?b:o?b[c]:(b[c]||{})[g];n&&(i=c);for(j in i)k=!m&&u&&void 0!==u[j],k&&j in s||(l=k?u[j]:i[j],s[j]=n&&"function"!=typeof u[j]?i[j]:q&&k?e(l,b):r&&u[j]==l?function(a){var b=function(b,c,d){if(this instanceof a){switch(arguments.length){case 0:return new a;case 1:return new a(b);case 2:return new a(b,c)}return new a(b,c,d)}return a.apply(this,arguments)};return b[g]=a[g],b}(l):p&&"function"==typeof l?e(Function.call,l):l,p&&((s.virtual||(s.virtual={}))[j]=l,a&h.R&&t&&!t[j]&&f(t,j,l)))};h.F=1,h.G=2,h.S=4,h.P=8,h.B=16,h.W=32,h.U=64,h.R=128,a.exports=h}),ua=c(ta),va=Object.freeze({default:ua}),wa=d(function(a){a.exports=c(sa)}),xa=c(wa),ya=Object.freeze({default:xa}),za=d(function(a){var b={}.hasOwnProperty;a.exports=function(a,c){return b.call(a,c)}}),Aa=c(za),Ba=Object.freeze({default:Aa}),Ca=d(function(a){var b=Math.ceil,c=Math.floor;a.exports=function(a){return isNaN(a=+a)?0:(a>0?c:b)(a)}}),Da=c(Ca),Ea=Object.freeze({default:Da}),Fa=d(function(a){var b=c(Ea),d=Math.min;a.exports=function(a){return a>0?d(b(a),9007199254740991):0}}),Ga=c(Fa),Ha=Object.freeze({default:Ga}),Ia=d(function(a){var b=c(Ea),d=Math.max,e=Math.min;a.exports=function(a,c){return a=b(a),a<0?d(a+c,0):e(a,c)}}),Ja=c(Ia),Ka=Object.freeze({default:Ja}),La=d(function(a){var b=c(z),d=c(Ha),e=c(Ka);a.exports=function(a){return function(c,f,g){var h,i=b(c),j=d(i.length),k=e(g,j);if(a&&f!=f){for(;j>k;)if(h=i[k++],h!=h)return!0}else for(;j>k;k++)if((a||k in i)&&i[k]===f)return a||k||0;return!a&&-1}}}),Ma=c(La),Na=Object.freeze({default:Ma}),Oa=d(function(a){var b=c(F),d="__core-js_shared__",e=b[d]||(b[d]={});a.exports=function(a){return e[a]||(e[a]={})}}),Pa=c(Oa),Qa=Object.freeze({default:Pa}),Ra=d(function(a){var b=0,c=Math.random();a.exports=function(a){return"Symbol(".concat(void 0===a?"":a,")_",(++b+c).toString(36))}}),Sa=c(Ra),Ta=Object.freeze({default:Sa}),Ua=d(function(a){var b=c(Qa)("keys"),d=c(Ta);a.exports=function(a){return b[a]||(b[a]=d(a))}}),Va=c(Ua),Wa=Object.freeze({default:Va}),Xa=d(function(a){var b=c(Ba),d=c(z),e=c(Na)(!1),f=c(Wa)("IE_PROTO");a.exports=function(a,c){var g,h=d(a),i=0,j=[];for(g in h)g!=f&&b(h,g)&&j.push(g);for(;c.length>i;)b(h,g=c[i++])&&(~e(j,g)||j.push(g));return j}}),Ya=c(Xa),Za=Object.freeze({default:Ya}),$a=d(function(a){a.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")}),_a=c($a),ab=Object.freeze({default:_a}),bb=d(function(a){var b=c(Za),d=c(ab);a.exports=Object.keys||function(a){return b(a,d)}}),cb=c(bb),db=Object.freeze({default:cb}),eb=d(function(a){var b=c(ma),d=c(V),e=c(db);a.exports=c(_)?Object.defineProperties:function(a,c){d(a);for(var f,g=e(c),h=g.length,i=0;h>i;)b.f(a,f=g[i++],c[f]);return a}}),fb=c(eb),gb=Object.freeze({default:fb}),hb=d(function(a){a.exports=c(F).document&&document.documentElement}),ib=c(hb),jb=Object.freeze({default:ib}),kb=d(function(a){var b=c(V),d=c(gb),e=c(ab),f=c(Wa)("IE_PROTO"),g=function(){},h="prototype",i=function(){var a,b=c(ca)("iframe"),d=e.length,f="<",g=">";for(b.style.display="none",c(jb).appendChild(b),b.src="javascript:",a=b.contentWindow.document,a.open(),a.write(f+"script"+g+"document.F=Object"+f+"/script"+g),a.close(),i=a.F;d--;)delete i[h][e[d]];return i()};a.exports=Object.create||function(a,c){var e;return null!==a?(g[h]=b(a),e=new g,g[h]=null,e[f]=a):e=i(),void 0===c?e:d(e,c)}}),lb=c(kb),mb=Object.freeze({default:lb}),nb=d(function(a){var b=c(Qa)("wks"),d=c(Ta),e=c(F).Symbol,f="function"==typeof e,g=a.exports=function(a){return b[a]||(b[a]=f&&e[a]||(f?e:d)("Symbol."+a))};g.store=b}),ob=c(nb),pb=Object.freeze({default:ob}),qb=d(function(a){var b=c(ma).f,d=c(Ba),e=c(pb)("toStringTag");a.exports=function(a,c,f){a&&!d(a=f?a:a.prototype,e)&&b(a,e,{configurable:!0,value:c})}}),rb=c(qb),sb=Object.freeze({default:rb}),tb=d(function(a){var b=c(mb),d=c(pa),e=c(sb),f={};c(sa)(f,c(pb)("iterator"),function(){return this}),a.exports=function(a,c,g){a.prototype=b(f,{next:d(1,g)}),e(a,c+" Iterator")}}),ub=c(tb),vb=Object.freeze({default:ub}),wb=d(function(a){var b=c(w);a.exports=function(a){return Object(b(a))}}),xb=c(wb),yb=Object.freeze({default:xb}),zb=d(function(a){var b=c(Ba),d=c(yb),e=c(Wa)("IE_PROTO"),f=Object.prototype;a.exports=Object.getPrototypeOf||function(a){return a=d(a),b(a,e)?a[e]:"function"==typeof a.constructor&&a instanceof a.constructor?a.constructor.prototype:a instanceof Object?f:null}}),Ab=c(zb),Bb=Object.freeze({default:Ab}),Cb=d(function(a){var b=c(C),d=c(va),e=c(ya),f=c(sa),g=c(Ba),h=c(n),i=c(vb),j=c(sb),k=c(Bb),l=c(pb)("iterator"),m=!([].keys&&"next"in[].keys()),o="@@iterator",p="keys",q="values",r=function(){return this};a.exports=function(a,c,n,s,t,u,v){i(n,c,s);var w,x,y,z=function(a){if(!m&&a in D)return D[a];switch(a){case p:return function(){return new n(this,a)};case q:return function(){return new n(this,a)}}return function(){return new n(this,a)}},A=c+" Iterator",B=t==q,C=!1,D=a.prototype,E=D[l]||D[o]||t&&D[t],F=E||z(t),G=t?B?z("entries"):F:void 0,H="Array"==c?D.entries||E:E;if(H&&(y=k(H.call(new a)),y!==Object.prototype&&(j(y,A,!0),b||g(y,l)||f(y,l,r))),B&&E&&E.name!==q&&(C=!0,F=function(){return E.call(this)}),b&&!v||!m&&!C&&D[l]||f(D,l,F),h[c]=F,h[A]=r,t)if(w={values:B?F:z(q),keys:u?F:z(p),entries:G},v)for(x in w)x in D||e(D,x,w[x]);else d(d.P+d.F*(m||C),c,w);return w}}),Db=c(Cb),Eb=Object.freeze({default:Db}),Fb=d(function(a){var b=c(h),d=c(k),e=c(n),f=c(z);a.exports=c(Eb)(Array,"Array",function(a,b){this._t=f(a),this._i=0,this._k=b},function(){var a=this._t,b=this._k,c=this._i++;return!a||c>=a.length?(this._t=void 0,d(1)):"keys"==b?d(0,c):"values"==b?d(0,a[c]):d(0,[c,a[c]])},"values"),e.Arguments=e.Array,b("keys"),b("values"),b("entries")});c(Fb);var Gb=d(function(a){for(var b=c(F),d=c(sa),e=c(n),f=c(pb)("toStringTag"),g=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],h=0;h<5;h++){var i=g[h],j=b[i],k=j&&j.prototype;k&&!k[f]&&d(k,f,i),e[i]=e.Array}});c(Gb);var Hb=d(function(a){var b=c(Ea),d=c(w);a.exports=function(a){return function(c,e){var f,g,h=String(d(c)),i=b(e),j=h.length;return i<0||i>=j?a?"":void 0:(f=h.charCodeAt(i),f<55296||f>56319||i+1===j||(g=h.charCodeAt(i+1))<56320||g>57343?a?h.charAt(i):f:a?h.slice(i,i+2):(f-55296<<10)+(g-56320)+65536)}}}),Ib=c(Hb),Jb=Object.freeze({default:Ib}),Kb=d(function(a){var b=c(Jb)(!0);c(Eb)(String,"String",function(a){this._t=String(a),this._i=0},function(){var a,c=this._t,d=this._i;return d>=c.length?{value:void 0,done:!0}:(a=b(c,d),this._i+=a.length,{value:a,done:!1})})});c(Kb);var Lb=d(function(a){var b=c(q),d=c(pb)("toStringTag"),e="Arguments"==b(function(){return arguments}()),f=function(a,b){try{return a[b]}catch(a){}};a.exports=function(a){var c,g,h;return void 0===a?"Undefined":null===a?"Null":"string"==typeof(g=f(c=Object(a),d))?g:e?b(c):"Object"==(h=b(c))&&"function"==typeof c.callee?"Arguments":h}}),Mb=c(Lb),Nb=Object.freeze({default:Mb}),Ob=d(function(a){var b=c(Nb),d=c(pb)("iterator"),e=c(n);a.exports=c(J).isIterable=function(a){var c=Object(a);return void 0!==c[d]||"@@iterator"in c||e.hasOwnProperty(b(c))}}),Pb=c(Ob),Qb=Object.freeze({default:Pb}),Rb=d(function(a){a.exports=c(Qb)}),Sb=c(Rb),Tb=Object.freeze({default:Sb}),Ub=d(function(a){a.exports={default:c(Tb),__esModule:!0}}),Vb=c(Ub),Wb=Object.freeze({default:Vb}),Xb=d(function(a){var b=c(Nb),d=c(pb)("iterator"),e=c(n);a.exports=c(J).getIteratorMethod=function(a){if(void 0!=a)return a[d]||a["@@iterator"]||e[b(a)]}}),Yb=c(Xb),Zb=Object.freeze({default:Yb}),$b=d(function(a){var b=c(V),d=c(Zb);a.exports=c(J).getIterator=function(a){var c=d(a);if("function"!=typeof c)throw TypeError(a+" is not iterable!");return b(c.call(a))}}),_b=c($b),ac=Object.freeze({default:_b}),bc=d(function(a){a.exports=c(ac)}),cc=c(bc),dc=Object.freeze({default:cc}),ec=d(function(a){a.exports={default:c(dc),__esModule:!0}}),fc=c(ec),gc=Object.freeze({default:fc}),hc=d(function(a,b){function d(a){return a&&a.__esModule?a:{default:a}}b.__esModule=!0;var e=c(Wb),f=d(e),g=c(gc),h=d(g);b.default=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,i=(0,h.default)(a);!(d=(g=i.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(a){e=!0,f=a}finally{try{!d&&i.return&&i.return()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if((0,f.default)(Object(b)))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()}),ic=c(hc),jc=d(function(a){a.exports=function(a,b,c,d){if(!(a instanceof b)||void 0!==d&&d in a)throw TypeError(c+": incorrect invocation!");return a}}),kc=c(jc),lc=Object.freeze({default:kc}),mc=d(function(a){var b=c(V);a.exports=function(a,c,d,e){try{return e?c(b(d)[0],d[1]):c(d)}catch(c){var f=a.return;throw void 0!==f&&b(f.call(a)),c}}}),nc=c(mc),oc=Object.freeze({default:nc}),pc=d(function(a){var b=c(n),d=c(pb)("iterator"),e=Array.prototype;a.exports=function(a){return void 0!==a&&(b.Array===a||e[d]===a)}}),qc=c(pc),rc=Object.freeze({default:qc}),sc=d(function(a){var b=c(P),d=c(oc),e=c(rc),f=c(V),g=c(Ha),h=c(Zb),i={},j={},k=a.exports=function(a,c,k,l,m){var n,o,p,q,r=m?function(){return a}:h(a),s=b(k,l,c?2:1),t=0;if("function"!=typeof r)throw TypeError(a+" is not iterable!");if(e(r)){for(n=g(a.length);n>t;t++)if(q=c?s(f(o=a[t])[0],o[1]):s(a[t]),q===i||q===j)return q}else for(p=r.call(a);!(o=p.next()).done;)if(q=d(p,s,o.value,c),q===i||q===j)return q};k.BREAK=i,k.RETURN=j}),tc=c(sc),uc=Object.freeze({default:tc}),vc=d(function(a){var b=c(V),d=c(M),e=c(pb)("species");a.exports=function(a,c){var f,g=b(a).constructor;return void 0===g||void 0==(f=b(g)[e])?c:d(f)}}),wc=c(vc),xc=Object.freeze({default:wc}),yc=d(function(a){a.exports=function(a,b,c){var d=void 0===c;switch(b.length){case 0:return d?a():a.call(c);case 1:return d?a(b[0]):a.call(c,b[0]);case 2:return d?a(b[0],b[1]):a.call(c,b[0],b[1]);case 3:return d?a(b[0],b[1],b[2]):a.call(c,b[0],b[1],b[2]);case 4:return d?a(b[0],b[1],b[2],b[3]):a.call(c,b[0],b[1],b[2],b[3])}return a.apply(c,b)}}),zc=c(yc),Ac=Object.freeze({default:zc}),Bc=d(function(a){var b,d,e,f=c(P),g=c(Ac),h=c(jb),i=c(ca),j=c(F),k=j.process,l=j.setImmediate,m=j.clearImmediate,n=j.MessageChannel,o=0,p={},r="onreadystatechange",s=function(){var a=+this;if(p.hasOwnProperty(a)){var b=p[a];delete p[a],b()}},t=function(a){s.call(a.data)};l&&m||(l=function(a){for(var c=[],d=1;arguments.length>d;)c.push(arguments[d++]);return p[++o]=function(){g("function"==typeof a?a:Function(a),c)},b(o),o},m=function(a){delete p[a]},"process"==c(q)(k)?b=function(a){k.nextTick(f(s,a,1))}:n?(d=new n,e=d.port2,d.port1.onmessage=t,b=f(e.postMessage,e,1)):j.addEventListener&&"function"==typeof postMessage&&!j.importScripts?(b=function(a){j.postMessage(a+"","*")},j.addEventListener("message",t,!1)):b=r in i("script")?function(a){h.appendChild(i("script"))[r]=function(){h.removeChild(this),s.call(a)}}:function(a){setTimeout(f(s,a,1),0)}),a.exports={set:l,clear:m}}),Cc=c(Bc),Dc=Bc.set,Ec=Bc.clear,Fc=Object.freeze({default:Cc,set:Dc,clear:Ec}),Gc=d(function(a){var b=c(F),d=c(Fc).set,e=b.MutationObserver||b.WebKitMutationObserver,f=b.process,g=b.Promise,h="process"==c(q)(f);a.exports=function(){var a,c,i,j=function(){var b,d;for(h&&(b=f.domain)&&b.exit();a;){d=a.fn,a=a.next;try{d()}catch(b){throw a?i():c=void 0,b}}c=void 0,b&&b.enter()};if(h)i=function(){f.nextTick(j)};else if(e){var k=!0,l=document.createTextNode("");new e(j).observe(l,{characterData:!0}),i=function(){l.data=k=!k}}else if(g&&g.resolve){var m=g.resolve();i=function(){m.then(j)}}else i=function(){d.call(b,j)};return function(b){var d={fn:b,next:void 0};c&&(c.next=d),a||(a=d,i()),c=d}}}),Hc=c(Gc),Ic=Object.freeze({default:Hc}),Jc=d(function(a){var b=c(sa);a.exports=function(a,c,d){for(var e in c)d&&a[e]?a[e]=c[e]:b(a,e,c[e]);return a}}),Kc=c(Jc),Lc=Object.freeze({default:Kc}),Mc=d(function(a){var b=c(F),d=c(J),e=c(ma),f=c(_),g=c(pb)("species");a.exports=function(a){var c="function"==typeof d[a]?d[a]:b[a];f&&c&&!c[g]&&e.f(c,g,{configurable:!0,get:function(){return this}})}}),Nc=c(Mc),Oc=Object.freeze({default:Nc}),Pc=d(function(a){var b=c(pb)("iterator"),d=!1;try{var e=[7][b]();e.return=function(){d=!0},Array.from(e,function(){throw 2})}catch(a){}a.exports=function(a,c){if(!c&&!d)return!1;var e=!1;try{var f=[7],g=f[b]();g.next=function(){return{done:e=!0}},f[b]=function(){return g},a(f)}catch(a){}return e}}),Qc=c(Pc),Rc=Object.freeze({default:Qc}),Sc=d(function(a){var b,d,e,f=c(C),g=c(F),h=c(P),i=c(Nb),j=c(va),k=c(S),l=c(M),m=c(lc),n=c(uc),o=c(xc),p=c(Fc).set,q=c(Ic)(),r="Promise",s=g.TypeError,t=g.process,u=g[r],t=g.process,v="process"==i(t),w=function(){},x=!!function(){try{var a=u.resolve(1),b=(a.constructor={})[c(pb)("species")]=function(a){a(w,w)};return(v||"function"==typeof PromiseRejectionEvent)&&a.then(w)instanceof b}catch(a){}}(),y=function(a,b){return a===b||a===u&&b===e},z=function(a){var b;return!(!k(a)||"function"!=typeof(b=a.then))&&b},A=function(a){return y(u,a)?new B(a):new d(a)},B=d=function(a){var b,c;this.promise=new a(function(a,d){if(void 0!==b||void 0!==c)throw s("Bad Promise constructor");b=a,c=d}),this.resolve=l(b),this.reject=l(c)},D=function(a){try{a()}catch(a){return{error:a}}},E=function(a,b){if(!a._n){a._n=!0;var c=a._c;q(function(){for(var d=a._v,e=1==a._s,f=0,g=function(b){var c,f,g=e?b.ok:b.fail,h=b.resolve,i=b.reject,j=b.domain;try{g?(e||(2==a._h&&I(a),a._h=1),g===!0?c=d:(j&&j.enter(),c=g(d),j&&j.exit()),c===b.promise?i(s("Promise-chain cycle")):(f=z(c))?f.call(c,h,i):h(c)):i(d)}catch(a){i(a)}};c.length>f;)g(c[f++]);a._c=[],a._n=!1,b&&!a._h&&G(a)})}},G=function(a){p.call(g,function(){var b,c,d,e=a._v;if(H(a)&&(b=D(function(){v?t.emit("unhandledRejection",e,a):(c=g.onunhandledrejection)?c({promise:a,reason:e}):(d=g.console)&&d.error&&d.error("Unhandled promise rejection",e)}),a._h=v||H(a)?2:1),a._a=void 0,b)throw b.error})},H=function(a){if(1==a._h)return!1;for(var b,c=a._a||a._c,d=0;c.length>d;)if(b=c[d++],b.fail||!H(b.promise))return!1;return!0},I=function(a){p.call(g,function(){var b;v?t.emit("rejectionHandled",a):(b=g.onrejectionhandled)&&b({promise:a,reason:a._v})})},K=function(a){var b=this;b._d||(b._d=!0,b=b._w||b,b._v=a,b._s=2,b._a||(b._a=b._c.slice()),E(b,!0))},L=function(a){var b,c=this;if(!c._d){c._d=!0,c=c._w||c;try{if(c===a)throw s("Promise can't be resolved itself");(b=z(a))?q(function(){var d={_w:c,_d:!1};try{b.call(a,h(L,d,1),h(K,d,1))}catch(a){K.call(d,a)}}):(c._v=a,c._s=1,E(c,!1))}catch(a){K.call({_w:c,_d:!1},a)}}};x||(u=function(a){m(this,u,r,"_h"),l(a),b.call(this);try{a(h(L,this,1),h(K,this,1))}catch(a){K.call(this,a)}},b=function(a){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},b.prototype=c(Lc)(u.prototype,{then:function(a,b){var c=A(o(this,u));return c.ok="function"!=typeof a||a,c.fail="function"==typeof b&&b,c.domain=v?t.domain:void 0,this._c.push(c),this._a&&this._a.push(c),this._s&&E(this,!1),c.promise},catch:function(a){return this.then(void 0,a)}}),B=function(){var a=new b;this.promise=a,this.resolve=h(L,a,1),this.reject=h(K,a,1)}),j(j.G+j.W+j.F*!x,{Promise:u}),c(sb)(u,r),c(Oc)(r),e=c(J)[r],j(j.S+j.F*!x,r,{reject:function(a){var b=A(this),c=b.reject;return c(a),b.promise}}),j(j.S+j.F*(f||!x),r,{resolve:function(a){if(a instanceof u&&y(a.constructor,this))return a;var b=A(this),c=b.resolve;return c(a),b.promise}}),j(j.S+j.F*!(x&&c(Rc)(function(a){u.all(a).catch(w)})),r,{all:function(a){var b=this,c=A(b),d=c.resolve,e=c.reject,f=D(function(){var c=[],f=0,g=1;n(a,!1,function(a){var h=f++,i=!1;c.push(void 0),g++,b.resolve(a).then(function(a){i||(i=!0,c[h]=a,--g||d(c))},e)}),--g||d(c)});return f&&e(f.error),c.promise},race:function(a){var b=this,c=A(b),d=c.reject,e=D(function(){n(a,!1,function(a){b.resolve(a).then(c.resolve,d)})});return e&&d(e.error),c.promise}})});c(Sc);var Tc=d(function(a){a.exports=c(J).Promise}),Uc=c(Tc),Vc=Object.freeze({default:Uc}),Wc=d(function(a){a.exports={default:c(Vc),__esModule:!0}}),Xc=c(Wc),Yc=d(function(a,b){b.f=Object.getOwnPropertySymbols}),Zc=c(Yc),$c=Yc.f,_c=Object.freeze({default:Zc,f:$c}),ad=d(function(a,b){b.f={}.propertyIsEnumerable}),bd=c(ad),cd=ad.f,dd=Object.freeze({default:bd,f:cd}),ed=d(function(a){var b=c(db),d=c(_c),e=c(dd),f=c(yb),g=c(t),h=Object.assign;a.exports=!h||c(Y)(function(){var a={},b={},c=Symbol(),d="abcdefghijklmnopqrst";return a[c]=7,d.split("").forEach(function(a){b[a]=a}),7!=h({},a)[c]||Object.keys(h({},b)).join("")!=d})?function(a,c){for(var h=f(a),i=arguments.length,j=1,k=d.f,l=e.f;i>j;)for(var m,n=g(arguments[j++]),o=k?b(n).concat(k(n)):b(n),p=o.length,q=0;p>q;)l.call(n,m=o[q++])&&(h[m]=n[m]);return h}:h}),fd=c(ed),gd=Object.freeze({default:fd}),hd=d(function(a){var b=c(va);b(b.S+b.F,"Object",{assign:c(gd)})});c(hd);var id=d(function(a){a.exports=c(J).Object.assign}),jd=c(id),kd=Object.freeze({default:jd}),ld=d(function(a){a.exports={default:c(kd),__esModule:!0}}),md=c(ld),nd=d(function(a,b){b.__esModule=!0,b.default=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}}),od=c(nd),pd=d(function(a,b){b.f=c(pb)}),qd=c(pd),rd=pd.f,sd=Object.freeze({default:qd,f:rd}),td=d(function(a){a.exports=c(sd).f("iterator")}),ud=c(td),vd=Object.freeze({default:ud}),wd=d(function(a){a.exports={default:c(vd),__esModule:!0}}),xd=c(wd),yd=Object.freeze({default:xd}),zd=d(function(a){var b=c(Ta)("meta"),d=c(S),e=c(Ba),f=c(ma).f,g=0,h=Object.isExtensible||function(){return!0},i=!c(Y)(function(){return h(Object.preventExtensions({}))}),j=function(a){f(a,b,{value:{i:"O"+ ++g,w:{}}})},k=function(a,c){if(!d(a))return"symbol"==typeof a?a:("string"==typeof a?"S":"P")+a;if(!e(a,b)){if(!h(a))return"F";if(!c)return"E";j(a)}return a[b].i},l=function(a,c){if(!e(a,b)){if(!h(a))return!0;if(!c)return!1;j(a)}return a[b].w},m=function(a){return i&&n.NEED&&h(a)&&!e(a,b)&&j(a),a},n=a.exports={KEY:b,NEED:!1,fastKey:k,getWeak:l,onFreeze:m}}),Ad=c(zd),Bd=zd.KEY,Cd=zd.NEED,Dd=zd.fastKey,Ed=zd.getWeak,Fd=zd.onFreeze,Gd=Object.freeze({default:Ad,KEY:Bd,NEED:Cd,fastKey:Dd,getWeak:Ed,onFreeze:Fd}),Hd=d(function(a){var b=c(F),d=c(J),e=c(C),f=c(sd),g=c(ma).f;a.exports=function(a){var c=d.Symbol||(d.Symbol=e?{}:b.Symbol||{});"_"==a.charAt(0)||a in c||g(c,a,{value:f.f(a)})}}),Id=c(Hd),Jd=Object.freeze({default:Id}),Kd=d(function(a){var b=c(db),d=c(z);a.exports=function(a,c){for(var e,f=d(a),g=b(f),h=g.length,i=0;h>i;)if(f[e=g[i++]]===c)return e}}),Ld=c(Kd),Md=Object.freeze({default:Ld}),Nd=d(function(a){var b=c(db),d=c(_c),e=c(dd);a.exports=function(a){var c=b(a),f=d.f;if(f)for(var g,h=f(a),i=e.f,j=0;h.length>j;)i.call(a,g=h[j++])&&c.push(g);return c}}),Od=c(Nd),Pd=Object.freeze({default:Od}),Qd=d(function(a){var b=c(q);a.exports=Array.isArray||function(a){return"Array"==b(a)}}),Rd=c(Qd),Sd=Object.freeze({default:Rd}),Td=d(function(a,b){var d=c(Za),e=c(ab).concat("length","prototype");b.f=Object.getOwnPropertyNames||function(a){return d(a,e)}}),Ud=c(Td),Vd=Td.f,Wd=Object.freeze({default:Ud,f:Vd}),Xd=d(function(a){var b=c(z),d=c(Wd).f,e={}.toString,f="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],g=function(a){try{return d(a)}catch(a){return f.slice()}};a.exports.f=function(a){return f&&"[object Window]"==e.call(a)?g(a):d(b(a))}}),Yd=c(Xd),Zd=Xd.f,$d=Object.freeze({default:Yd,f:Zd}),_d=d(function(a,b){var d=c(dd),e=c(pa),f=c(z),g=c(ia),h=c(Ba),i=c(fa),j=Object.getOwnPropertyDescriptor;b.f=c(_)?j:function(a,b){if(a=f(a),b=g(b,!0),i)try{return j(a,b)}catch(a){}if(h(a,b))return e(!d.f.call(a,b),a[b])}}),ae=c(_d),be=_d.f,ce=Object.freeze({default:ae,f:be}),de=d(function(a){var b=c(F),d=c(Ba),e=c(_),f=c(va),g=c(ya),h=c(Gd).KEY,i=c(Y),j=c(Qa),k=c(sb),l=c(Ta),m=c(pb),n=c(sd),o=c(Jd),p=c(Md),q=c(Pd),r=c(Sd),s=c(V),t=c(z),u=c(ia),v=c(pa),w=c(mb),x=c($d),y=c(ce),A=c(ma),B=c(db),D=y.f,E=A.f,G=x.f,H=b.Symbol,I=b.JSON,J=I&&I.stringify,K="prototype",L=m("_hidden"),M=m("toPrimitive"),N={}.propertyIsEnumerable,O=j("symbol-registry"),P=j("symbols"),Q=j("op-symbols"),R=Object[K],S="function"==typeof H,T=b.QObject,U=!T||!T[K]||!T[K].findChild,W=e&&i(function(){return 7!=w(E({},"a",{get:function(){return E(this,"a",{value:7}).a}})).a})?function(a,b,c){var d=D(R,b);d&&delete R[b],E(a,b,c),d&&a!==R&&E(R,b,d)}:E,X=function(a){var b=P[a]=w(H[K]);return b._k=a,b},Z=S&&"symbol"==typeof H.iterator?function(a){return"symbol"==typeof a}:function(a){return a instanceof H},$=function(a,b,c){return a===R&&$(Q,b,c),s(a),b=u(b,!0),s(c),d(P,b)?(c.enumerable?(d(a,L)&&a[L][b]&&(a[L][b]=!1),c=w(c,{enumerable:v(0,!1)})):(d(a,L)||E(a,L,v(1,{})),a[L][b]=!0),W(a,b,c)):E(a,b,c)},aa=function(a,b){s(a);for(var c,d=q(b=t(b)),e=0,f=d.length;f>e;)$(a,c=d[e++],b[c]);return a},ba=function(a,b){return void 0===b?w(a):aa(w(a),b)},ca=function(a){var b=N.call(this,a=u(a,!0));return!(this===R&&d(P,a)&&!d(Q,a))&&(!(b||!d(this,a)||!d(P,a)||d(this,L)&&this[L][a])||b)},da=function(a,b){if(a=t(a),b=u(b,!0),a!==R||!d(P,b)||d(Q,b)){var c=D(a,b);return!c||!d(P,b)||d(a,L)&&a[L][b]||(c.enumerable=!0),c}},ea=function(a){for(var b,c=G(t(a)),e=[],f=0;c.length>f;)d(P,b=c[f++])||b==L||b==h||e.push(b);return e},fa=function(a){for(var b,c=a===R,e=G(c?Q:t(a)),f=[],g=0;e.length>g;)!d(P,b=e[g++])||c&&!d(R,b)||f.push(P[b]);return f};S||(H=function(){if(this instanceof H)throw TypeError("Symbol is not a constructor!");var a=l(arguments.length>0?arguments[0]:void 0),b=function(c){this===R&&b.call(Q,c),d(this,L)&&d(this[L],a)&&(this[L][a]=!1),W(this,a,v(1,c))};return e&&U&&W(R,a,{configurable:!0,set:b}),X(a)},g(H[K],"toString",function(){return this._k}),y.f=da,A.f=$,c(Wd).f=x.f=ea,c(dd).f=ca,c(_c).f=fa,e&&!c(C)&&g(R,"propertyIsEnumerable",ca,!0),n.f=function(a){return X(m(a))}),f(f.G+f.W+f.F*!S,{Symbol:H});for(var ga="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ha=0;ga.length>ha;)m(ga[ha++]);for(var ga=B(m.store),ha=0;ga.length>ha;)o(ga[ha++]);f(f.S+f.F*!S,"Symbol",{for:function(a){return d(O,a+="")?O[a]:O[a]=H(a)},keyFor:function(a){if(Z(a))return p(O,a);throw TypeError(a+" is not a symbol!")},useSetter:function(){U=!0},useSimple:function(){U=!1}}),f(f.S+f.F*!S,"Object",{create:ba,defineProperty:$,defineProperties:aa,getOwnPropertyDescriptor:da,getOwnPropertyNames:ea,getOwnPropertySymbols:fa}),I&&f(f.S+f.F*(!S||i(function(){var a=H();return"[null]"!=J([a])||"{}"!=J({a:a})||"{}"!=J(Object(a))})),"JSON",{stringify:function(a){if(void 0!==a&&!Z(a)){for(var b,c,d=[a],e=1;arguments.length>e;)d.push(arguments[e++]);return b=d[1],"function"==typeof b&&(c=b),!c&&r(b)||(b=function(a,b){if(c&&(b=c.call(this,a,b)),!Z(b))return b}),d[1]=b,J.apply(I,d)}}}),H[K][M]||c(sa)(H[K],M,H[K].valueOf),k(H,"Symbol"),k(Math,"Math",!0),k(b.JSON,"JSON",!0)});c(de);var ee=d(function(a){c(Jd)("asyncIterator")});c(ee);var fe=d(function(a){c(Jd)("observable")});c(fe);var ge=d(function(a){a.exports=c(J).Symbol}),he=c(ge),ie=Object.freeze({default:he}),je=d(function(a){a.exports={default:c(ie),__esModule:!0}}),ke=c(je),le=Object.freeze({default:ke}),me=d(function(a,b){function d(a){return a&&a.__esModule?a:{default:a}}b.__esModule=!0;var e=c(yd),f=d(e),g=c(le),h=d(g),i="function"==typeof h.default&&"symbol"==typeof f.default?function(a){return typeof a}:function(a){return a&&"function"==typeof h.default&&a.constructor===h.default?"symbol":typeof a};b.default="function"==typeof h.default&&"symbol"===i(f.default)?function(a){return"undefined"==typeof a?"undefined":i(a)}:function(a){return a&&"function"==typeof h.default&&a.constructor===h.default?"symbol":"undefined"==typeof a?"undefined":i(a)}}),ne=c(me),oe=Object.freeze({default:ne}),pe=d(function(a,b){function d(a){return a&&a.__esModule?a:{default:a}}b.__esModule=!0;var e=c(oe),f=d(e);b.default=function(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==("undefined"==typeof b?"undefined":(0,f.default)(b))&&"function"!=typeof b?a:b}}),qe=c(pe),re=d(function(a){var b=c(S),d=c(V),e=function(a,c){if(d(a),!b(c)&&null!==c)throw TypeError(c+": can't set as prototype!")};a.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(a,b,d){try{d=c(P)(Function.call,c(ce).f(Object.prototype,"__proto__").set,2),d(a,[]),b=!(a instanceof Array)}catch(a){b=!0}return function(a,c){return e(a,c),b?a.__proto__=c:d(a,c),a}}({},!1):void 0),check:e}}),se=c(re),te=re.set,ue=re.check,ve=Object.freeze({default:se,set:te,check:ue}),we=d(function(a){var b=c(va);b(b.S,"Object",{setPrototypeOf:c(ve).set})});c(we);var xe=d(function(a){a.exports=c(J).Object.setPrototypeOf}),ye=c(xe),ze=Object.freeze({default:ye}),Ae=d(function(a){a.exports={default:c(ze),__esModule:!0}}),Be=c(Ae),Ce=Object.freeze({default:Be}),De=d(function(a){var b=c(va);b(b.S,"Object",{create:c(mb)})});c(De);var Ee=d(function(a){var b=c(J).Object;a.exports=function(a,c){return b.create(a,c)}}),Fe=c(Ee),Ge=Object.freeze({default:Fe}),He=d(function(a){a.exports={default:c(Ge),__esModule:!0}}),Ie=c(He),Je=Object.freeze({default:Ie}),Ke=d(function(a,b){function d(a){return a&&a.__esModule?a:{default:a}}b.__esModule=!0;var e=c(Ce),f=d(e),g=c(Je),h=d(g),i=c(oe),j=d(i);b.default=function(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof b?"undefined":(0,j.default)(b)));a.prototype=(0,h.default)(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(f.default?(0,f.default)(a,b):a.__proto__=b)}}),Le=c(Ke),Me=d(function(a){function b(a,b,c){this.fn=a,this.context=b,this.once=c||!1}function c(){}var d=Object.prototype.hasOwnProperty,e="function"!=typeof Object.create&&"~";c.prototype._events=void 0,c.prototype.eventNames=function(){var a,b=this._events,c=[];if(!b)return c;for(a in b)d.call(b,a)&&c.push(e?a.slice(1):a);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(b)):c},c.prototype.listeners=function(a,b){var c=e?e+a:a,d=this._events&&this._events[c];if(b)return!!d;if(!d)return[];if(d.fn)return[d.fn];for(var f=0,g=d.length,h=new Array(g);f<g;f++)h[f]=d[f].fn;return h},c.prototype.emit=function(a,b,c,d,f,g){var h=e?e+a:a;if(!this._events||!this._events[h])return!1;var i,j,k=this._events[h],l=arguments.length;if("function"==typeof k.fn){switch(k.once&&this.removeListener(a,k.fn,void 0,!0),l){case 1:return k.fn.call(k.context),!0;case 2:return k.fn.call(k.context,b),!0;case 3:return k.fn.call(k.context,b,c),!0;case 4:return k.fn.call(k.context,b,c,d),!0;case 5:return k.fn.call(k.context,b,c,d,f),!0;case 6:return k.fn.call(k.context,b,c,d,f,g),!0}for(j=1,i=new Array(l-1);j<l;j++)i[j-1]=arguments[j];k.fn.apply(k.context,i)}else{var m,n=k.length;for(j=0;j<n;j++)switch(k[j].once&&this.removeListener(a,k[j].fn,void 0,!0),l){case 1:k[j].fn.call(k[j].context);break;case 2:k[j].fn.call(k[j].context,b);break;case 3:k[j].fn.call(k[j].context,b,c);break;default:if(!i)for(m=1,i=new Array(l-1);m<l;m++)i[m-1]=arguments[m];k[j].fn.apply(k[j].context,i)}}return!0},c.prototype.on=function(a,c,d){var f=new b(c,d||this),g=e?e+a:a;return this._events||(this._events=e?{}:Object.create(null)),this._events[g]?this._events[g].fn?this._events[g]=[this._events[g],f]:this._events[g].push(f):this._events[g]=f,this},c.prototype.once=function(a,c,d){var f=new b(c,d||this,(!0)),g=e?e+a:a;return this._events||(this._events=e?{}:Object.create(null)),this._events[g]?this._events[g].fn?this._events[g]=[this._events[g],f]:this._events[g].push(f):this._events[g]=f,this},c.prototype.removeListener=function(a,b,c,d){var f=e?e+a:a;if(!this._events||!this._events[f])return this;var g=this._events[f],h=[];if(b)if(g.fn)(g.fn!==b||d&&!g.once||c&&g.context!==c)&&h.push(g);else for(var i=0,j=g.length;i<j;i++)(g[i].fn!==b||d&&!g[i].once||c&&g[i].context!==c)&&h.push(g[i]);return h.length?this._events[f]=1===h.length?h[0]:h:delete this._events[f],
this},c.prototype.removeAllListeners=function(a){return this._events?(a?delete this._events[e?e+a:a]:this._events=e?{}:Object.create(null),this):this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prototype.setMaxListeners=function(){return this},c.prefixed=e,"undefined"!=typeof a&&(a.exports=c)}),Ne=c(Me),Oe=d(function(a){var b=c(va);b(b.S+b.F*!c(_),"Object",{defineProperty:c(ma).f})});c(Oe);var Pe=d(function(a){var b=c(J).Object;a.exports=function(a,c,d){return b.defineProperty(a,c,d)}}),Qe=c(Pe),Re=Object.freeze({default:Qe}),Se=d(function(a){a.exports={default:c(Re),__esModule:!0}}),Te=c(Se),Ue=Object.freeze({default:Te}),Ve=d(function(a,b){function d(a){return a&&a.__esModule?a:{default:a}}b.__esModule=!0;var e=c(Ue),f=d(e);b.default=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),(0,f.default)(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}()}),We=c(Ve),Xe=d(function(a,b){!function(){var c={VERSION:"2.3.5",Result:{SUCCEEDED:1,NOTRANSITION:2,CANCELLED:3,PENDING:4},Error:{INVALID_TRANSITION:100,PENDING_TRANSITION:200,INVALID_CALLBACK:300},WILDCARD:"*",ASYNC:"async",create:function(a,b){var d="string"==typeof a.initial?{state:a.initial}:a.initial,e=a.terminal||a.final,f=b||a.target||{},g=a.events||[],h=a.callbacks||{},i={},j={},k=function(a){var b=a.from instanceof Array?a.from:a.from?[a.from]:[c.WILDCARD];i[a.name]=i[a.name]||{};for(var d=0;d<b.length;d++)j[b[d]]=j[b[d]]||[],j[b[d]].push(a.name),i[a.name][b[d]]=a.to||b[d]};d&&(d.event=d.event||"startup",k({name:d.event,from:"none",to:d.state}));for(var l=0;l<g.length;l++)k(g[l]);for(var m in i)i.hasOwnProperty(m)&&(f[m]=c.buildEvent(m,i[m]));for(var m in h)h.hasOwnProperty(m)&&(f[m]=h[m]);return f.current="none",f.is=function(a){return a instanceof Array?a.indexOf(this.current)>=0:this.current===a},f.can=function(a){return!this.transition&&(i[a].hasOwnProperty(this.current)||i[a].hasOwnProperty(c.WILDCARD))},f.cannot=function(a){return!this.can(a)},f.transitions=function(){return j[this.current]},f.isFinished=function(){return this.is(e)},f.error=a.error||function(a,b,c,d,e,f,g){throw g||f},d&&!d.defer&&f[d.event](),f},doCallback:function(a,b,d,e,f,g){if(b)try{return b.apply(a,[d,e,f].concat(g))}catch(b){return a.error(d,e,f,g,c.Error.INVALID_CALLBACK,"an exception occurred in a caller-provided callback function",b)}},beforeAnyEvent:function(a,b,d,e,f){return c.doCallback(a,a.onbeforeevent,b,d,e,f)},afterAnyEvent:function(a,b,d,e,f){return c.doCallback(a,a.onafterevent||a.onevent,b,d,e,f)},leaveAnyState:function(a,b,d,e,f){return c.doCallback(a,a.onleavestate,b,d,e,f)},enterAnyState:function(a,b,d,e,f){return c.doCallback(a,a.onenterstate||a.onstate,b,d,e,f)},changeState:function(a,b,d,e,f){return c.doCallback(a,a.onchangestate,b,d,e,f)},beforeThisEvent:function(a,b,d,e,f){return c.doCallback(a,a["onbefore"+b],b,d,e,f)},afterThisEvent:function(a,b,d,e,f){return c.doCallback(a,a["onafter"+b]||a["on"+b],b,d,e,f)},leaveThisState:function(a,b,d,e,f){return c.doCallback(a,a["onleave"+d],b,d,e,f)},enterThisState:function(a,b,d,e,f){return c.doCallback(a,a["onenter"+e]||a["on"+e],b,d,e,f)},beforeEvent:function(a,b,d,e,f){if(!1===c.beforeThisEvent(a,b,d,e,f)||!1===c.beforeAnyEvent(a,b,d,e,f))return!1},afterEvent:function(a,b,d,e,f){c.afterThisEvent(a,b,d,e,f),c.afterAnyEvent(a,b,d,e,f)},leaveState:function(a,b,d,e,f){var g=c.leaveThisState(a,b,d,e,f),h=c.leaveAnyState(a,b,d,e,f);return!1!==g&&!1!==h&&(c.ASYNC===g||c.ASYNC===h?c.ASYNC:void 0)},enterState:function(a,b,d,e,f){c.enterThisState(a,b,d,e,f),c.enterAnyState(a,b,d,e,f)},buildEvent:function(a,b){return function(){var d=this.current,e=b[d]||b[c.WILDCARD]||d,f=Array.prototype.slice.call(arguments);if(this.transition)return this.error(a,d,e,f,c.Error.PENDING_TRANSITION,"event "+a+" inappropriate because previous transition did not complete");if(this.cannot(a))return this.error(a,d,e,f,c.Error.INVALID_TRANSITION,"event "+a+" inappropriate in current state "+this.current);if(!1===c.beforeEvent(this,a,d,e,f))return c.Result.CANCELLED;if(d===e)return c.afterEvent(this,a,d,e,f),c.Result.NOTRANSITION;var g=this;this.transition=function(){return g.transition=null,g.current=e,c.enterState(g,a,d,e,f),c.changeState(g,a,d,e,f),c.afterEvent(g,a,d,e,f),c.Result.SUCCEEDED},this.transition.cancel=function(){g.transition=null,c.afterEvent(g,a,d,e,f)};var h=c.leaveState(this,a,d,e,f);return!1===h?(this.transition=null,c.Result.CANCELLED):c.ASYNC===h?c.Result.PENDING:this.transition?this.transition():void 0}}};"undefined"!=typeof b?("undefined"!=typeof a&&a.exports&&(b=a.exports=c),b.StateMachine=c):"function"==typeof define&&define.amd?define(function(a){return c}):"undefined"!=typeof window?window.StateMachine=c:"undefined"!=typeof self&&(self.StateMachine=c)}()}),Ye=c(Xe),Ze=function(){return Ye.create({initial:"calling",events:[{name:"connect",from:"calling",to:"connected"},{name:"close",from:"connected",to:"closed"},{name:"cancel",from:"calling",to:"canceled"},{name:"refuse",from:"calling",to:"refused"}]})},$e=d(function(a,b){!function(c){function d(a){var b=l(a);if(r)for(var c,d=0;c=u[d++];)a.hasOwnProperty(c)&&b.push(c);return b}function e(a,b,c){for(var e,f,g=d(c),i=0,j=g.length;i<j;)"__self"!==(e=g[i++])&&(f=c[e],p(f)&&!f.prototype.__self&&(!h||f.toString().indexOf(".__base")>-1)?b[e]=function(c,d){var e=a[c]?a[c]:"__constructor"===c?b.__self.__parent:q,f=function(){var a=this.__base;this.__base=f.__base;var b=d.apply(this,arguments);return this.__base=a,b};return f.__base=e,f}(e,f):b[e]=f)}function f(a,b){for(var c,d=1;c=a[d++];)b?p(c)?g.self(b,c.prototype,c):g.self(b,c):b=p(c)?g(a[0],c.prototype,c):g(a[0],c);return b||a[0]}function g(){var a=arguments,b=o(a[0]),c=b||p(a[0]),d=c?b?f(a[0]):a[0]:i,g=a[c?1:0]||{},h=a[c?2:1],j=g.__constructor||c&&d.prototype.__constructor?function(){return this.__constructor.apply(this,arguments)}:c?function(){return d.apply(this,arguments)}:function(){};if(!c)return j.prototype=g,j.prototype.__self=j.prototype.constructor=j,m(j,h);m(j,d),j.__parent=d;var l=d.prototype,n=j.prototype=k(l);return n.__self=n.constructor=j,g&&e(l,n,g),h&&e(d,j,h),j}var h=function(){return"_"}.toString().indexOf("_")>-1,i=function(){},j=Object.prototype.hasOwnProperty,k=Object.create||function(a){var b=function(){};return b.prototype=a,new b},l=Object.keys||function(a){var b=[];for(var c in a)j.call(a,c)&&b.push(c);return b},m=function(a,b){for(var c in b)j.call(b,c)&&(a[c]=b[c]);return a},n=Object.prototype.toString,o=Array.isArray||function(a){return"[object Array]"===n.call(a)},p=function(a){return"[object Function]"===n.call(a)},q=function(){},r=!0,s={toString:""};for(var t in s)s.hasOwnProperty(t)&&(r=!1);var u=r?["toString","valueOf"]:null;g.self=function(){var a=arguments,b=o(a[0]),c=b?f(a[0],a[0][0]):a[0],d=a[1],g=a[2],h=c.prototype;return d&&e(h,h,d),g&&e(c,c,g),c};var v=!0;"object"==typeof b&&(a.exports=g,v=!1),"object"==typeof modules&&"function"==typeof modules.define&&(modules.define("inherit",function(a){a(g)}),v=!1),"function"==typeof define&&(define(function(a,b,c){c.exports=g}),v=!1),v&&(c.inherit=g)}(e)}),_e=c($e),af=Object.freeze({default:_e}),bf=d(function(a){a.exports=c(af)}),cf=c(bf);if(!b.TypedMessage)throw new Error("LeanCloud Realtime SDK not installed");var df=cf(b.TypedMessage,{__constructor:function(a){this.__base(),this.payload=a,this.setTransient(!0)}});b.messageField("payload")(df);var ef,ff,gf,hf,jf,kf,lf,mf,nf,of,pf=(ef=b.messageType(-102),ef(ff=function(a){function b(){return od(this,b),qe(this,a.apply(this,arguments))}return Le(b,a),b}(df))||ff),qf=(gf=b.messageType(-103),gf(hf=function(a){function b(){return od(this,b),qe(this,a.apply(this,arguments))}return Le(b,a),b}(df))||hf),rf=(jf=b.messageType(-104),jf(kf=function(a){function b(){return od(this,b),qe(this,a.apply(this,arguments))}return Le(b,a),b}(df))||kf),sf=(lf=b.messageType(-105),lf(mf=function(a){function b(){return od(this,b),qe(this,a.apply(this,arguments))}return Le(b,a),b}(df))||mf),tf=function(a){function b(c,d){od(this,b);var e=qe(this,a.call(this));e._setConversation(c),e._peerConnection=e._createPeerConnection(d),e._call=Ze(),e._promises={};var f=new Xc(function(a){e._promises.resolveStreamReady=a}),g=new Xc(function(a){e._promises.resolveAccept=a});return Xc.all([f,g]).then(function(a){var b=ic(a,1),c=b[0];e._call.can("connect")&&(e._call.connect(),e.emit("connect",c))}),e}return Le(b,a),b.prototype.close=function(){var a=this;return Xc.resolve().then(function(){a._call.close(),a._destroyPeerConnection(),a._peerConnection.close(),a._destroy()})},b.prototype._handleCloseEvent=function(){this._call.can("close")&&(this.close(),this.emit("close"))},b.prototype._setConversation=function(a){this._conversation&&this._conversation.off("message"),a&&(this._conversation=a,a.on("message",this._handleMessage.bind(this)))},b.prototype._destroy=function(){this._conversation.off("message")},b.prototype._createPeerConnection=function(a){var b=new RTCPeerConnection(a);return b.onicecandidate=this._handleICECandidateEvent.bind(this),b.onaddstream=this._handleAddStreamEvent.bind(this),b.onnremovestream=this._handleRemoveStreamEvent.bind(this),b.oniceconnectionstatechange=this._handleICEConnectionStateChangeEvent.bind(this),b.onsignalingstatechange=this._handleSignalingStateChangeEvent.bind(this),b},b.prototype._destroyPeerConnection=function(){var a=this._peerConnection;delete a.onaddstream,delete a.onremovestream,delete a.onnicecandidate,delete a.oniceconnectionstatechange,delete a.onsignalingstatechange},b.prototype._handleMessage=function(a){return a instanceof pf?this._handleAnswer(a):a instanceof rf?this._handleRefusal():a instanceof sf?this._handleCancelation():a instanceof qf&&this._handleICECandidate(a)},b.prototype._handleICECandidate=function(a){var b=new RTCIceCandidate(a.payload);this._peerConnection&&this._peerConnection.addIceCandidate(b).catch(console.error.bind(console))},b.prototype._handleICECandidateEvent=function(a){return!(!a.candidate||!this._conversation)&&this._conversation.send(new qf(a.candidate)).catch(console.error.bind(console))},b.prototype._handleAddStreamEvent=function(a){this._promises.resolveStreamReady(a.stream)},b.prototype._handleRemoveStreamEvent=function(){this._handleCloseEvent()},b.prototype._handleICEConnectionStateChangeEvent=function(){switch(this._peerConnection.iceConnectionState){case"closed":case"failed":case"disconnected":this._handleCloseEvent()}},b.prototype._handleSignalingStateChangeEvent=function(){switch(this._peerConnection.signalingState){case"closed":this._handleCloseEvent()}},b.prototype._handleAnswer=function(){throw new Error("not implemented")},b.prototype._handleRefusal=function(){throw new Error("not implemented")},b.prototype._handleCancelation=function(){throw new Error("not implemented")},We(b,[{key:"state",get:function(){return this._call.current}}]),b}(Ne),uf=function(a){function b(c,d,e){od(this,b);var f=qe(this,a.call(this,d,e));return f.to=c,f}return Le(b,a),b.prototype._handleAnswer=function(a){var b=new RTCSessionDescription(a.payload);this._peerConnection.setRemoteDescription(b),this._promises.resolveAccept()},b.prototype._handleRefusal=function(){this._destroyPeerConnection(),this._call.refuse(),this.emit("refuse"),this._destroy()},b.prototype.cancel=function(){var a=this;return this._call.cancel(),this._conversation.send(new sf).then(function(){return a._destroy()})},b.prototype.close=function(){return this._call.can("cancel")?this.cancel():a.prototype.close.call(this)},b}(tf),vf=function(a){function b(c,d,e){od(this,b);var f=qe(this,a.call(this,d,e));f.from=c.from;var g=new RTCSessionDescription(c.payload);return f._handleOfferPromise=f._peerConnection.setRemoteDescription(g),f}return Le(b,a),b.prototype.accept=function(a){var b=this;if(!a)throw new TypeError("a MediaStream instance is required to accept a call");return this._handleOfferPromise.then(function(){return b._peerConnection.addStream(a)}).then(function(){return b._peerConnection.createAnswer()}).then(function(a){return b._peerConnection.setLocalDescription(a)}).then(function(){return b._conversation.send(new pf(b._peerConnection.localDescription))}).then(function(){return b._promises.resolveAccept()})},b.prototype.refuse=function(){var a=this;return this._conversation.send(new rf).then(function(){a._call.refuse(),a._destroy()})},b.prototype._handleCancelation=function(){this._call.cancel(),this.emit("cancel"),this._destroy()},b}(tf),wf=(nf=b.messageType(-101),nf(of=function(a){function b(){return od(this,b),qe(this,a.apply(this,arguments))}return Le(b,a),b}(df))||of),xf={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:stun1.l.google.com:19302","stun:stun2.l.google.com:19302","stun:stun3.l.google.com:19302","stun:stun4.l.google.com:19302","stun:stun.ekiga.net","stun:stun.ideasip.com","stun:stun.rixtelecom.se","stun:stun.schlund.de","stun:stun.stunprotocol.org:3478","stun:stun.voiparound.com","stun:stun.voipbuster.com","stun:stun.voipstunt.com","stun:stun.voxgratia.org"]}]},yf=function(a){function b(c,d){if(od(this,b),"string"!=typeof c)throw new TypeError("id is not a string");var e=qe(this,a.call(this));return e.id=c,e.options=md({RTCConfiguration:xf},d),e}return Le(b,a),b.prototype._open=function(a,b){var c=this;return a.createIMClient(this.id,b,"webrtc").then(function(a){return c._imClient=a,a.on("message",function(a,b){return a instanceof wf&&c._handleOffer(a,b)}),a.on("conflict",function(){for(var a=arguments.length,b=Array(a),d=0;d<a;d++)b[d]=arguments[d];return c.emit.apply(c,["conflict"].concat(b))}),c})},b.prototype.close=function(){return this._imClient.close()},b.prototype.call=function(a,b){var c=this;if("string"!=typeof a)throw new TypeError("target id is not a string");if(!b)throw new TypeError("a MediaStream instance is required to make a call");return this._imClient.ping([a]).then(function(d){if(!d.length)throw new Error(a+" is not online");var e=new uf(a,null,c.options.RTCConfiguration),f=new Xc(function(a){e._peerConnection.onnegotiationneeded=a});return e._peerConnection.addStream(b),f.then(function(){return Xc.all([c._imClient.createConversation({members:[a],unique:!0}),e._peerConnection.createOffer().then(function(a){e._peerConnection.setLocalDescription(a)})])}).then(function(a){var b=ic(a,1),c=b[0];return e._setConversation(c),c.send(new wf(e._peerConnection.localDescription))}).then(function(){return e})})},b.prototype._handleOffer=function(a,b){var c=new vf(a,b,this.options.RTCConfiguration);this.emit("call",c)},b}(Ne),zf="leancloud-realtime-plugin-webrtc",Af=[wf,pf,qf,rf,sf],Bf=function(a){a.createWebRTCClient=function(b,c){return new yf(b)._open(a,c)}},Cf={name:zf,messageClasses:Af,onRealtimeCreate:Bf};a.WebRTCPlugin=Cf,Object.defineProperty(a,"__esModule",{value:!0})});
//# sourceMappingURL=webrtc.min.js.map